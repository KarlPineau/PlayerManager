{# src/DnDInstance/CharacterBundle/Resources/views/CharacterUsed/view/view_content.html.twig #}
{% if app.user == characterUsed.user or is_granted('ROLE_ADMIN') %}
    {% set allowEdit = true %}
{% else %}
    {% set allowEdit = false %}
{% endif %}

<div class="row">
    <section id="content" class="col-lg-12">
        {% for flashMessage in app.session.flashbag.get('notice') %}
            <div class="alert alert-success">
                {{ flashMessage }}
            </div>
        {% endfor %}
        
        <div class="jumbotron">
            <h2>{{characterUsed.name}}</h2>
            {% if allowEdit == true and profile == 'short' %}<a href="{{ path('dndinstance_characterused_characterused_view', {'slug': characterUsed.slug, 'inline': false, 'profile': 'full'}) }}" target="_blank">Profil complet</a>{% endif %}
            <div class="row">
                <div class="col-md-3">
                    <small><a href="{{path('cas_administration_user_view', { 'id' : characterUsed.user.id})}}" target="_blank">{{characterUsed.user.username}}</a></small>
                </div>
                <div class="col-md-3">
                    Race : <a href="{{path('dndrules_race_race_view', {'slug': characterUsed.race.slug})}}" target="_blank">{{characterUsed.race.name}}</a><br />
                </div>
                <div class="col-md-3">
                    {% for instance in characterUsed.classDnDInstances %}
                        Classe : <a href="{{path('dndrules_classdnd_classdnd_view', {'slug': instance.classDnD.slug})}}" target="_blank">{{instance.classDnD.name}}</a><br />
                        Niveau : {{instance.level.level}} {% if dndinstance_character_characteruseddnd.isNewLevel(characterUsed) %}<a href="{{ path('dndinstance_characterused_characterused_edit_upgradelevel', {'slug': characterUsed.slug}) }}"><strong>Upgrade disponible !</strong></a>{% endif %}<br />
                    {% endfor %}
                    Exp. : {{xpPoints.increase}}/{{xpForLevelUp}}XP
                </div>
                <div class="col-md-3">
                    PV : {{characterUsed.hpCurrent}}/{{characterUsed.hpMax}}
                </div>
            </div>
        </div>

        {% if allowEdit == true %}
            <div class="panel panel-warning">
                <div class="panel-heading">Info personnage</div>
                <div class="panel-body">
                    Ici les info du type :
                    - "Vous avez le droit à 1 point de plus sur tel cara"
                    - "Telle et telle cara sont trop haute pour votre niveau" ...
                </div>
            </div>
        {% endif %}

        <div role="tabpanel">
            <!-- Nav tabs -->
            <ul class="nav nav-tabs" role="tablist" id="UserTab">
                <li role="presentation" class="active"><a href="#home{{characterUsed.slug}}" aria-controls="home{{characterUsed.slug}}" role="tab" data-toggle="tab">Présentation</a></li>
                <li role="presentation"><a href="#rp{{characterUsed.slug}}" aria-controls="rp{{characterUsed.slug}}" role="tab" data-toggle="tab">Role Play</a></li>
                <li role="presentation"><a href="#equipment{{characterUsed.slug}}" aria-controls="equipment{{characterUsed.slug}}" role="tab" data-toggle="tab">Equipement</a></li>
                <li role="presentation"><a href="#skills{{characterUsed.slug}}" aria-controls="skills{{characterUsed.slug}}" role="tab" data-toggle="tab">Compétences</a></li>
                <li role="presentation"><a href="#magic{{characterUsed.slug}}" aria-controls="magic{{characterUsed.slug}}" role="tab" data-toggle="tab">Magie</a></li>
                <li role="presentation"><a href="#gifts{{characterUsed.slug}}" aria-controls="gifts{{characterUsed.slug}}" role="tab" data-toggle="tab">Dons</a></li>
                <li role="presentation"><a href="#statistics{{characterUsed.slug}}" aria-controls="statistics{{characterUsed.slug}}" role="tab" data-toggle="tab">Statistiques</a></li>
            </ul>

            <!-- Tab panes -->
            <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="home{{characterUsed.slug}}">
                    {% include 'DnDInstanceCharacterBundle:CharacterUsed:view/view_home.html.twig' %}
                </div>
                <div role="tabpanel" class="tab-pane" id="rp{{characterUsed.slug}}">
                    {% include 'DnDInstanceCharacterBundle:CharacterUsed:view/view_rp.html.twig' %}
                </div>
                <div role="tabpanel" class="tab-pane" id="equipment{{characterUsed.slug}}">
                    {% include 'DnDInstanceCharacterBundle:CharacterUsed:view/view_equipment.html.twig' %}
                </div>
                <div role="tabpanel" class="tab-pane" id="skills{{characterUsed.slug}}">
                    {% include 'DnDInstanceCharacterBundle:CharacterUsed:view/view_skills.html.twig' %}
                </div>
                <div role="tabpanel" class="tab-pane" id="magic{{characterUsed.slug}}">
                    {% include 'DnDInstanceCharacterBundle:CharacterUsed:view/view_magic.html.twig' %}
                </div>
                <div role="tabpanel" class="tab-pane" id="gifts{{characterUsed.slug}}">
                    {% include 'DnDInstanceCharacterBundle:CharacterUsed:view/view_gifts.html.twig' %}
                </div>
                <div role="tabpanel" class="tab-pane" id="statistics{{characterUsed.slug}}">
                    {% include 'DnDInstanceCharacterBundle:CharacterUsed:view/view_statistics.html.twig' %}
                </div>
            </div>
        </div>
    </section>
</div>